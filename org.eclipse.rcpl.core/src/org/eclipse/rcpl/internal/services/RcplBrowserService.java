/*******************************************************************************
 * Copyright (c) 2003 - 2014 Ramin Assisi and others.
 * All rights reserved. This program and the accompanying materials 
 * are made available under the terms of the Common Public License v1.0
 * which accompanies this distribution, and is available at
 * http://www.eclipse.org/legal/cpl-v10.html
 * 
 * Contributors:
 *     Ramin Assisi - initial implementation
 *******************************************************************************/

package org.eclipse.rcpl.internal.services;

import org.eclipse.rcpl.ICommand;

/**
 * @author eclipse
 * 
 */
public class RcplBrowserService extends RcplService {

	public RcplBrowserService() {
		super();
	}

	@Override
	public Object doExecute(ICommand command) throws Exception {

		//		if (getId(command).equals("browser/actions/browser/test")) { //$NON-NLS-1$
		// JO.officePane.layout(false, true);
		// return true;
		// }
		//
		//		//		if (getId(command).startsWith("browser/actions/browser/open_word")) { //$NON-NLS-1$
		// // JO.service.getInfoTabService().createNewWordDocument();
		// // return true;
		// // }
		//
		//		if (getId(command).startsWith("browser/actions/browser/open_more")) { //$NON-NLS-1$
		// boolean sel = (Boolean) command.getNewData()[0];
		// JO.officePane.updateToolLayout(sel ? 128 : 67);
		// return true;
		// }
		//
		//		if (getId(command).startsWith("browser/actions/browser/open_")) { //$NON-NLS-1$
		//
		// // String key = command.getEntry().getKey();
		// // String url;
		// // boolean openNewTab = true;
		//			//			String s = key.substring("browser/actions/browser/open_".length(), //$NON-NLS-1$
		// // key.length());
		//			//			s = "infotab/actions/setup/setup_site_" + s; //$NON-NLS-1$
		// // url = JOUtil2.getDefaultString(s);
		// // // if (JOUtil.isProductElderBrowser()) {
		// // // openNewTab = false;
		// // // }
		// //
		// // String tabName = null;
		// // Object o = command.getSource();
		// // if (o instanceof IButtonTool) {
		// // IButtonTool b = (IButtonTool) o;
		// // tabName = b.getTabName();
		// // }
		// //
		// // CTabItem2 existingTab = null;
		// // if (tabName != null) {
		// // ITabItem[] items = JO.officePane.getEditorFolder().getItems();
		// // for (int i = 1; i < items.length; i++) {
		// // if (tabName.equals(items[i].getText())) {
		// // openNewTab = false;
		// // existingTab = (CTabItem2) items[i];
		// // break;
		// // }
		// // }
		// // }
		// //
		// // if (!openNewTab
		// // && getEditorFigure() != null
		// // && getEditorFigure().getEditorArea().getAdvancedBrowser() !=
		// // null) {
		// // if (existingTab != null) {
		// // JO.officePane.getEditorFolder().setSelection(existingTab);
		// // }
		// // String urlOld = getEditorFigure().getEditorArea()
		// // .getAdvancedBrowser().getUrl();
		// // String urlOld2 = getEditorFigure().getEditorArea()
		// // .getAdvancedBrowser().getUrl2();
		// // String urlOld3 = getEditorFigure().getEditorArea()
		// // .getAdvancedBrowser().getHyperLinkedUrl();
		// //
		// // if (url != null && !url.equals(urlOld) && !url.equals(urlOld2)
		// // && !url.equals(urlOld3)) {
		// // getEditorFigure().getEditorArea().getAdvancedBrowser()
		// // .setUrl(url);
		// // }
		// // } else {
		// // CTabItem2 item = (CTabItem2) JO.officePane.addBrowserTab(url,
		// // tabName, openNewTab, false);
		// // if (tabName != null) {
		// // item.setText(tabName);
		// // }
		// // }
		// // // JOUtil.getEditorFigure().showAspect();
		//
		// return true;
		// }

		//		if (match(command, "browser/actions/browser/delete_history")) { //$NON-NLS-1$
		// TODO
		// JOToolComponentHistoryViewFigure f =
		// (JOToolComponentHistoryViewFigure) JOUtil
		// .findEditorToolComponents(
		//							"browser/actions/browser/history_view").get(0); //$NON-NLS-1$
		// JODocumentList l = f.getDocumentViewer().getDocumentList();
		// l.clearRecentlyBrowsedUrls();
		// f.getDocumentViewer().refresh();
		// return true;
		// }
		//
		//		if (match(command, "browser/actions/browser/secure_login")) { //$NON-NLS-1$
		// String masterPassword = JOMasterPasswordDialog.open();
		// if (masterPassword != null) {
		// JOAdvancedBrowser ab = editorFigure.getEditorArea()
		// .getAdvancedBrowser();
		// if (ab != null) {
		// WebView browser = ab.getBrowser();
		// String url = browser.getEngine().getLocation();
		// JOWebsiteLogin login = JOWebsiteLogin.find(url);
		// if (login != null) {
		// String pw = login.getPassword(masterPassword);
		// // postString(login.user, browser, 20);
		// // JOUtil.sleep(100);
		//						//						postString("\t", browser, 20); //$NON-NLS-1$
		// // JOUtil.sleep(100);
		// // postString(pw, browser, 20);
		// // JOUtil.sleep(100);
		//						//						postString("\r", browser, 20); //$NON-NLS-1$
		// }
		// }
		// }
		// return true;
		// }
		//
		//		if (match(command, "browser/actions/browser/add_to_favorites")) { //$NON-NLS-1$
		// JOAdvancedBrowser ab = editorFigure.getEditorArea()
		// .getAdvancedBrowser();
		// if (ab != null) {
		// String url = ab.getUrl();
		// ITool tool = JOUtil2.findEditorTools(
		//						"browser/actions/browser/favorites_view").get(0); //$NON-NLS-1$
		// IToolComponent f = tool.getToolComponent();
		// f.getDocumentViewer().addEntry(JOUtil2.getInstanceProperties(),
		// JO.REGISTRY_FAVORITE_URL, url);
		// }
		// return true;
		// }
		//
		//		if (match(command, "browser/actions/browser/find_what")) { //$NON-NLS-1$
		// String findString = (String) command.getNewData()[0];
		// if (editorFigure.getEditorArea().getAdvancedBrowser() != null) {
		// editorFigure.getEditorArea().getAdvancedBrowser()
		// .find(findString, true, false, true);
		// IComboTool combo = (IComboTool) command.getSource();
		// Control c = (Control) combo.getControl();
		// c.setFocus();
		// }
		// return true;
		// }
		//
		//		if (match(command, "browser/actions/browser/find_next")) { //$NON-NLS-1$
		// JOToolCombo tool = (JOToolCombo) editorFigure.getToolRegistry()
		//					.findTools("browser/actions/browser/find_what").get(0); //$NON-NLS-1$
		// JOSWTToolComponentCombo toolCombo = (JOSWTToolComponentCombo)
		// tool
		// .getToolComponent();
		// JOWTToolComponentImageCombo combo = (JOWTToolComponentImageCombo)
		// toolCombo
		// .getSwtTool();
		// String findString = combo.getText();
		// editorFigure.getEditorArea().getAdvancedBrowser()
		// .find(findString, false, false, false);
		// return true;
		// }
		//
		//		if (match(command, "browser/actions/browser/find_backwards")) { //$NON-NLS-1$
		// JOToolCombo tool = (JOToolCombo) editorFigure.getToolRegistry()
		//					.findTools("browser/actions/browser/find_what").get(0); //$NON-NLS-1$
		// JOSWTToolComponentCombo toolCombo = (JOSWTToolComponentCombo)
		// tool
		// .getToolComponent();
		// JOWTToolComponentImageCombo combo = (JOWTToolComponentImageCombo)
		// toolCombo
		// .getSwtTool();
		// String findString = combo.getText();
		// editorFigure.getEditorArea().getAdvancedBrowser()
		// // .find(findString, false, true, false);
		// return true;
		// }
		//
		//		if (match(command, "browser/actions/browser/search_engine")) { //$NON-NLS-1$
		// return true;
		// }
		//
		//		if (match(command, "browser/actions/browser/bookmark")) { //$NON-NLS-1$
		// bookmark(command);
		// return true;
		// }
		//
		// if (getId(command).startsWith(
		//				"browser/actions/browser/search_engine_default_")) { //$NON-NLS-1$
		//
		// // TODO:
		//			//			int pos = command.getEntry().getKey().lastIndexOf("_"); //$NON-NLS-1$
		// // int index = Integer.valueOf(command.getEntry().getKey()
		// // .substring(pos + 1, command.getEntry().getKey().length())) - 1;
		// //
		// JOWTToolComponentBrowserSearch.INSTANCE.setSearchEngineIndex(index);
		// // JOWTToolComponentBrowserSearch.INSTANCE.getMainLayer().repaint();
		// // JOUtil.getAbstractOfficePane().getToolDialog().hide();
		// return true;
		// }

		//		if (getId(command).startsWith("browser/actions/browser/search_engine_")) { //$NON-NLS-1$
		// goSearch(command);
		// // TODO
		// // JOUtil.getAbstractOfficePane().getToolDialog().hide();
		// return true;
		// }
		//
		//		if (match(command, "browser/actions/browser/search_engine_go")) { //$NON-NLS-1$
		// goSearch(command);
		// return true;
		// }
		//
		//		if (match(command, "browser/actions/browser/tooldialog_delete")) { //$NON-NLS-1$
		//
		// TODO:

		// JOToolComponentAbstractToolFigure tool =
		// (JOToolComponentAbstractToolFigure) command
		// .getNewData()[0];
		// @SuppressWarnings("unchecked")
		// List<JOToolComponent> components = (List<JOToolComponent>)
		// command
		// .getNewData()[1];
		// String dialogKey = tool.getEntry().getKey();
		//			if (dialogKey.equals("browser/actions/browser/history")) { //$NON-NLS-1$
		// for (JOToolComponent joToolComponent : components) {
		// if (joToolComponent instanceof JOToolComponentHistoryViewFigure)
		// {
		// JOToolComponentHistoryViewFigure v =
		// (JOToolComponentHistoryViewFigure) joToolComponent;
		// if (MessageDialog
		// .openQuestion(
		// JOUtil.getShell(),
		// Messages.JOBrowserService_DeleteHistory,
		// Messages.JOBrowserService_DoYouWantToDeleteAllHistory)) {
		// v.getDocumentViewer().getDocumentList()
		// .clearRecentlyBrowsedUrls();
		// }
		// }
		// }
		// }
		// return true;
		// }
		//		if (match(command, "browser/actions/browser/back")) { //$NON-NLS-1$
		// JOAdvancedBrowser browser = (JOAdvancedBrowser) editorFigure
		// .getBrowserComposite().getChildren()[0];
		// browser.back();
		// return true;
		// }
		//		if (match(command, "browser/actions/browser/forward")) { //$NON-NLS-1$
		// JOAdvancedBrowser browser = (JOAdvancedBrowser) editorFigure
		// .getBrowserComposite().getChildren()[0];
		// browser.forward();
		// return true;
		// }
		//		if (match(command, "browser/actions/browser/refresh")) { //$NON-NLS-1$
		// JOAdvancedBrowser browser = (JOAdvancedBrowser) editorFigure
		// .getBrowserComposite().getChildren()[0];
		// browser.refresh();
		// return true;
		// }
		//
		//		if (match(command, "browser/actions/browser/stop")) { //$NON-NLS-1$
		// JOAdvancedBrowser browser = (JOAdvancedBrowser) editorFigure
		// .getBrowserComposite().getChildren()[0];
		// browser.getBrowser().getEngine().stop();
		// return true;
		// }
		//
		//		if (match(command, "browser/actions/browser/browser_home")) { //$NON-NLS-1$
		// String home = JOUtil2
		//					.getString("infotab/actions/setup/setup_browser_url_home"); //$NON-NLS-1$
		// if (home != null) {
		// TODO
		// JOEditorArea editorArea =
		// JO.officePane.getSelectedEditorArea();
		// if (editorArea != null) {
		// if (editorArea.getAdvancedBrowser() != null) {
		// editorArea.getAdvancedBrowser().setUrl(home);
		// JO.officePane.getEditorFolder().getSelection()
		// .setText(Messages.JOBrowserService_Home);
		// }
		// }
		// JO.officePane.addBrowserTab(home,
		// JOUtil.getUrlDisplayName(home), false, true);
		// }
		// return true;
		// }
		//
		// url.addVerifyListener(new VerifyListener() {
		// @Override
		// public void verifyText(VerifyEvent e) {
		// if (e.keyCode == SWT.CR) {
		// e.doit = false;
		// if (item != null) {
		// item.setText(url.getText());
		// }
		// browser.setUrl(url.getText());
		// }
		// }
		// });
		//
		return false;
	}

	//
	// /**
	// *
	// */
	// public void bookmark(JOCommand command) {
	//
	// ITool tool = JOUtil2.findEditorTools(
	//				"browser/actions/browser/bookmarks_view").get(0); //$NON-NLS-1$
	// IViewFigure f = (IViewFigure) tool.getToolComponent();
	// IDocumentList documentList = f.getDocumentViewer().getDocumentList();
	// JOAdvancedBrowser browser = (JOAdvancedBrowser) ef
	// .getBrowserComposite().getChildren()[0];
	// String url = browser.getBrowser().getUrl();
	// documentList.addBookmarkUrl(url, true);
	// f.getDocumentViewer().refresh();
	// }
	//
	// /**
	// * @param command
	// */
	// @SuppressWarnings("unused")
	// private void goSearch(JOCommand command) {
	//
	// TODO
	// String searchUrl = null;
	// String searchString = JOWTToolComponentBrowserSearch.INSTANCE
	// .getTextControl().getText();
	// JOUtil.getDefaultDB().insertSearchString(searchString);
	// if (command.getNewData()[0] instanceof String) {
	// searchUrl = (String) command.getNewData()[0];
	// } else {
	// JOToolComponentButtonFigure b = (JOToolComponentButtonFigure) command
	// .getSource();
	// JOWTToolComponentBrowserSearch tool =
	// JOWTToolComponentBrowserSearch.INSTANCE;
	// String s = b.getEntry().getKey();
	// SearchEngine searchEngine;
	//			if (s.startsWith("browser/actions/browser/search_engine_go")) { //$NON-NLS-1$
	// searchEngine = tool.getSearchEngine();
	//			} else if (s.startsWith("browser/actions/browser/search_engine_")) { //$NON-NLS-1$
	//				String[] splits = s.split("_"); //$NON-NLS-1$
	// Integer index = Integer.valueOf(splits[splits.length - 1]);
	// searchEngine = tool.getSearchEngines().get(index - 1);
	//
	// } else {
	// searchEngine = tool.getSearchEngine();
	// }
	// searchUrl = searchEngine.url;
	// }
	//
	// searchUrl = searchUrl.replaceAll(JO.TEMPLATEVAR_1, searchString);
	//
	// CTabItem2 existingTab = null;
	// CTabItem2[] items = JO.officePane.getEditorFolder().getItems();
	// for (int i = 1; i < items.length; i++) {
	// if (Messages.JOOfficePane_SearchResult.equals(items[i].getText())) {
	// existingTab = items[i];
	// break;
	// }
	// }
	//
	// if (JOUtil.isProductElderBrowser()) {
	// if (existingTab != null) {
	// JO.officePane.getEditorFolder().setSelection(existingTab);
	// } else {
	// CTabItem2 item = JO.officePane.addBrowserTab(
	//						"", Messages.JOOfficePane_SearchResult, true, false); //$NON-NLS-1$
	// }
	// }
	//
	// getEditorFigure().getEditorArea().getAdvancedBrowser()
	// .setUrl(searchUrl, true);
	//
	// }
	//
	// /**
	// * @param txt
	// * @param widget
	// */
	// private void postString(String txt, Widget widget, int millis) {
	// for (int i = 0; i < txt.length(); i++) {
	// String c = txt.substring(i, i + 1);
	// Event e = new Event();
	// int keycode = c.getBytes()[0];
	// char ch = c.toCharArray()[0];
	// Event e0 = null;
	//			if (c.equals("@")) { //$NON-NLS-1$
	// // first SHIFT
	// e0 = new Event();
	// e0.type = SWT.KeyDown;
	// e0.button = 0;
	// e0.keyCode = SWT.SHIFT;
	// e0.character = 0;
	// e0.widget = widget;
	// widget.getDisplay().post(e0);
	// keycode = 39;
	// ch = '@';
	// e.stateMask = SWT.SHIFT;
	// }
	// e.type = SWT.KeyDown;
	// e.button = 0;
	// e.keyCode = keycode;
	// e.character = ch;
	// e.widget = widget;
	// widget.getDisplay().post(e);
	// e.type = SWT.KeyUp;
	// widget.getDisplay().post(e);
	// if (e0 != null) {
	// e0.type = SWT.KeyUp;
	// widget.getDisplay().post(e0);
	// }
	//
	// JOUtil.sleep(millis);
	// }
	// }

	/**
	 * 
	 */
	public void showWelcomePage() {
		// JO.officePane.closeAllEditors();
		//
		// if (JO.browserTopTools != null) {
		// JO.browserTopTools.refresh(true);
		// }
		// String url = JO.WEB_HOME_WELCOME_2 +
		// Locale.getDefault().getLanguage()
		//				+ ".html"; //$NON-NLS-1$
		// JO.officePane.getEditorFolder().setSelection(1);
		// // JOAdvancedBrowser browser = (JOAdvancedBrowser) getEditorFigure()
		// // .getBrowserComposite().getChildren()[0];
		// // browser.setUrl(url);
	}

}
